# EDU01M 整合測試 #

# 功能說明 #

## 開機模式 ##

- 一般模式<br>
上電後正常開機，依預設網路進行連線，連線後會取得網路時間，並發送設備控制連結，可由網頁控制開發版，取得開發版狀態，TimeOut時間6分鐘，當無法連線時，設備將自動重啟。

- 配置模式<br>
短按按鈕，開機時，同時按下按鈕開關，當燈號亮起後放開，燈號快閃，進入系統配置模式，等待使用者連線設定。

- 單機模式<br>
長按按鈕，開機時，同時按下按鈕開關，當燈號長滅，大約三秒以上，進入單機模式，系統將以單機運行，不處理所有網路連線作業。

## 感測引腳 ##
系統預設的引腳連線如下：<br>

- **LED指示**<br>
連接 **GPIO 0**，使用 MCU 內部的上拉電路，燒錄韌體時，需要將 GPIO 0 接地(GND)並重啟進入燒錄模式。

- **按鈕開關**<br>
連接 **GPIO 12**，開關模組，使用 MCU 內部的上拉電路，需以 **INPUT_PULLUP** 模式進行操作。

- **蜂鳴器**<br>
連接 **GPIO 9**，預設的事件驅動引腳，可在配置模式中，更改事件驅動引腳，當人體、氣體、比較器等等感測器觸發時，產生事件驅動 HIGH 訊號。

- **繼電器開關**<br>
連接 **GPIO 10**，使用 **HIGH**、LOW 控制外部開關，可在配置模式中，更改事件驅動引腳。

- **人體感測**<br>
連接 **GPIO 13**，預設觸發時，訊號為 **HIGH**，未觸發時，訊號為 LOW。

- **氣體感測**<br>
連接 **GPIO 16**，可連接 MQ2 等等的氣體感測模組，讀取數位引腳，當事件觸發時，訊號為 **LOW**。

- **比較器A,B**<br>
連接 **GPIO 2**，有兩組比較器提供連接，分別為(A+,A-)與(B+,B-)，可連接火焰感測模組或雨滴感測模組等等，事件觸發時，訊號偵測為 **LOW**，且板上有觸發的燈號與各自的靈敏度調節器。

- **紅外線接收**<br>
連接 **GPIO 14**，紅外線接收是用來學習其他遙控器的紅外線訊號，當系統開機後，長按按鈕開關，直到蜂鳴器發出一短聲，系統會進入紅外線學習模式，3秒間進行紅外線學習，當學習完成或逾時，蜂鳴器發出兩短聲結束學習，想要切換不同的訊息組，只能由開機發送的超連結網頁中，選擇不同的紅外線按鈕。

- **紅外線發射**<br>
連接 **GPIO 15**，用來發射紅外線訊號，以便控制紅外線家電設備，如冷氣、風扇等等，當系統開機後，按放按鈕開關會進行紅外線發射，預設為紅外線第一組訊息，從開機提供的網路連結訊息，可以控制四組紅外線按鈕。

- **電壓量測**<br>
連接 **ADC 0**，為類比輸入引腳，用來讀取電池的電壓，測量時，A0連接到開發板的A0端口，電池正極連接太陽能電壓測量正極，可量測的電壓範圍從 0~20V。

- **I2C通訊**<br>
連接 **GPIO 4,5**，I2C通訊使用兩隻引腳，可控制多項傳感器，包含DHT12的溫溼度感測、OLED顯示屏幕等等。

## 畫面資訊 ##
學習版上有 OLED 單色螢幕的擴充插槽，可顯示攝氏溫度與電池電壓，以及當前的日期時間，當事件觸發，狀態會立即顯示，無觸發時，每分鐘會更新一次數據。<br>
![alt text](../../img/oled.jpg "EDU01M 開發版顯示屏幕")

## LINE通知 ##
想要設備擁有 LINE 通知的功能，必須取 LINE Token ，將 LINE Token 字串設定到**配置模式**中，以下說明設置的流程：


1. 首先用網頁登入 [LINE Notify](https://notify-bot.line.me/) 官網首頁`https://notify-bot.line.me/`，如果不知道怎麼登入，請先在 LINE 中設置郵件地址與登入密碼，然後以郵件地址與密碼登入。
2. 點選網頁右上角的**個人頁面**，如果沒有下拉選單，請將手機網頁切換到PC模式。<br>
![alt text](../../img/01LINE_Notify_logon.png "LINE Notify 個人頁面")
3. 點選發行權杖，然後選擇您要通知的對象，建議先在LINE中建立一個通知群組，然後選擇這個群組作為通知對象。<br>
![alt text](../../img/02get_line_token.png "發行權杖取得 LINE TOKEN")]
4. 選擇通知對象後，會產生一組長長的字串，這組字串就是 **LINE TOKEN**，請保存好這個字串並且不要將字串外流，當網頁退出後，此字串就會消失。
5. 有了權杖(LINE TOKEN)後，就可以啟動設備進入**配置模式**，將剛剛取得的權杖字串填入並保存，記得輸入WiFi的連線帳號與密碼，保存並重新開機後，就可以在手機收取 LINE 通知了，至於怎麼進入配置模式，請回頭看看開機模式的功能說明。